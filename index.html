<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>POST Request to Power Automate</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin-top: 50px;
    }
    #response {
      margin-top: 20px;
      font-weight: bold;
      color: green;
    }
  </style>
</head>
<body>
  <h2 id="message">Sending POST Request to Power Automate Flow...</h2>

  <div id="response">Loading...</div>

  <script>
    let postUrl = null;

    const equipmentType = getQueryParam('equipment');
    const messageEl = document.getElementById('message');

    
    function getQueryParam(param) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(param);
    }

      if (!equipmentType) {
        messageEl.textContent = "No equipment specified.";
      } else {
        // Run different code based on equipment type
        switch(equipmentType.toLowerCase()) {
          case 'ev2':
            postUrl = "https://prod-144.westus.logic.azure.com:443/workflows/f6c0893e198040aaacce7a676f0d9716/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=ipK5A_w4lWczwH_ytJ-kPpLysrukIjvCaGricj09D8c"
            break;
          case 'ev1':
            postUrl = "https://prod-29.westus.logic.azure.com:443/workflows/09bffac70b0445a992b9bf6fbfdb8780/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=8Gs0thzxf0lLK9ITTV9kAQRdWMWh5oUIgtRpithNfBo"
            break;
          case 'gator1':
            postUrl = "https://prod-26.westus.logic.azure.com:443/workflows/f29a4ce0dfda4a7ba96b9877667c2724/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=aJ-gDlV9JNoPaSXDiSAIxq0pqqgEheFpg28BW8J-ESU"
            break;
          case 'gator2':
            postUrl = "https://prod-29.westus.logic.azure.com:443/workflows/d42de6cf62aa49c9b7703435ecf89877/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=xsl-ifF5tLx4aV1fUrxOuaAWQxVj5iXNsi6RA9PIb7Y"
            break;
          case 'forklift':
            postUrl = "https://defaultaad523c05eba4f99a71343a0609578.cb.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/4f1a148e6a55464182af704c43d0cf51/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=UI0AHn2oNnzTShRtIChcgC3D9yR2v_JFbWR2PXhkzrk"
            break;
          case 'telehandler':
            postUrl = "https://prod-41.westus.logic.azure.com:443/workflows/acb9ced646f14f79a6f08f3fed4ca792/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=_mI79drv0MsYJztU_37tps12WC4YFa5-MkbbbRm-jwE"
            break;
          case 'sissor-lift':
            postUrl = "https://prod-05.westus.logic.azure.com:443/workflows/089f5eb30f5e4bcca60e9ace834ee2a0/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=csRtsQSQfp3YRWHm0Oe7WvycAhmMSmLKaFhG6amQ8to"
            break;
          case 'man-basket':
            postUrl = "https://prod-07.westus.logic.azure.com:443/workflows/aba0aaba610f4e85ade1ac9f12dd6450/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=MEGO-CjdNeD0UUHH-WP870Xp1PApVUmS88pL0BgEMOQ"
            break;
          default:
            messageEl.textContent = "Unknown equipment: " + equipmentType;
        }
      }

      if(postUrl){
        // Send POST request immediately when page loads
        (async function sendPostRequest() {
          const payload = {
            message: "Hello from the HTML page!",
            timestamp: new Date().toISOString()
          };

          try {
            const response = await fetch(postUrl, {
              method: "POST",
              headers: {
                "Content-Type": "application/json"
              },
              body: JSON.stringify(payload)
            });

            if (response.ok) {
              const responseText = await response.text();

              // Replace the current page content with the response
              document.open();
              document.write(responseText);
              document.close();

            } else {
              document.getElementById("response").textContent = `Request failed with status: ${response.status}`;
            }
          } catch (error) {
            document.getElementById("response").textContent = `Error: ${error.message}`;
          }
        })();

      }
  </script>
</body>
</html>

